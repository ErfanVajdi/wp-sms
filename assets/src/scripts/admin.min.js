(()=>{jQuery(document).ready((function(){e.init()}));var e={init:function(){this.setFields(),this.addEventListener()},setFields:function(){this.fromNumber=jQuery(".js-replyModalToggle"),this.toNumber=jQuery(".js-wpSmsQuickReplyTo"),this.replyMessage=jQuery(".js-wpSmsQuickReplyMessage"),this.submitButton=jQuery(".quick-reply-submit")},addEventListener:function(){this.fromNumber.on("click",function(e){this.replyMessage.val(""),jQuery(".wpsms-quick-reply-popup").removeClass("not-hidden"),jQuery(".wpsms-quick-reply-popup").addClass("hidden"),this.toNumber.attr("value",e.delegateTarget.dataset.number),this.fromNumber.attr("data-group-id")&&this.toNumber.attr("data-group-id",e.delegateTarget.dataset.groupId)}.bind(this)),this.submitButton.on("click",function(e){var s=this.bindData(),t={sender:wpSmsGlobalTemplateVar.senderID,recipients:s.recipient,message:this.replyMessage.val(),numbers:s.numbers,group_ids:s.groupId,media_urls:[]};jQuery.ajax({url:wpSmsGlobalTemplateVar.restUrls.sendSms,headers:{"X-WP-Nonce":wpSmsGlobalTemplateVar.nonce},dataType:"json",type:"POST",contentType:"application/json",data:JSON.stringify(t),beforeSend:function(){jQuery('input[name="SendSMS"]').attr("disabled","disabled"),jQuery(".wpsms-sendsms__overlay").css("display","flex")},success:function(e,s,t){jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").removeClass("notice notice-error"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").addClass("notice notice-success"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").html("<p>"+e.message+"</p>"),jQuery(".wpsms-quick-reply-popup").removeClass("hidden"),jQuery(".wpsms-quick-reply-popup").addClass("not-hidden"),jQuery('input[name="SendSMS"]').prop("disabled",!1),jQuery(".js-wpSmsQuickReply").attr("data-reload")&&location.reload()},error:function(e,s,t){jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").removeClass("notice notice-success"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").addClass("notice notice-error"),jQuery(".wpsms-quick-reply-popup .wp-sms-popup-messages").html("<p>"+e.responseJSON.error.message+"</p>"),jQuery(".wpsms-quick-reply-popup").removeClass("hidden"),jQuery(".wpsms-quick-reply-popup").addClass("not-hidden"),jQuery('input[name="SendSMS"]').prop("disabled",!1)}})}.bind(this))},bindData:function(){var e={};return this.fromNumber.attr("data-group-id")?(e.recipient="subscribers",e.numbers=[],e.groupId=[this.toNumber.attr("data-group-id")]):(e.recipient="numbers",e.numbers=[this.toNumber.attr("value")],e.groupId=[]),e}}})(),(()=>{function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,s){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,n,r,o,l=[],a=!0,d=!1;try{if(r=(t=t.call(e)).next,0===s){if(Object(t)!==t)return;a=!1}else for(;!(a=(i=r.call(t)).done)&&(l.push(i.value),l.length!==s);a=!0);}catch(e){d=!0,n=e}finally{try{if(!a&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(d)throw n}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,s){(null==s||s>e.length)&&(s=e.length);for(var t=0,i=new Array(s);t<s;t++)i[t]=e[t];return i}jQuery(document).ready((function(){t.init()}));var t={init:function(){this.setFields(),this.uploadEventListener(),this.selectColumnFileHeaderEventListener(),this.selectOrAddGroup(),this.disableSelectedOptions(),this.bindImportRequestBody(),this.refreshEventListener()},setFields:function(){this.uploadForm=jQuery(".js-wpSmsUploadForm"),this.importButton=jQuery(".js-wpSmsImportButton"),this.uploadButton=jQuery(".js-wpSmsUploadButton"),this.refreshButton=jQuery(".js-wpSmsRefreshButton"),this.loadingSpinner=jQuery(".js-wpSmsOverlay"),this.messageModal=jQuery(".js-wpSmsMessageModal"),this.modalErrorMessage=jQuery(".js-wpSmsErrorMessage"),this.importStep2=jQuery(".js-WpSmsImportStep2"),this.hasHeader=jQuery(".js-wpSmsFileHasHeader"),this.importResult=jQuery(".js-WpSmsImportResult"),this.importResultTable=jQuery(".js-WpSmsImportResult table tbody"),this.requestBody={},this.import_result={},this.successUpload=0},uploadEventListener:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;e.uploadForm.on("submit",function(s){s.preventDefault();var t=jQuery("#wp-sms-input-file")[0].files,i=new FormData;t.length>0&&i.append("file",t[0]);var n=!1;e.hasHeader.is(":checked")&&(n=!0),jQuery.ajax({url:wpSmsGlobalTemplateVar.ajaxUrls.uploadSubscriberCsv+"&hasHeader="+n,method:"post",data:i,contentType:!1,cache:!1,processData:!1,beforeSend:function(){e.uploadButton.attr("disabled","disabled"),e.loadingSpinner.css("display","flex")},success:function(s,t,i){setTimeout((function(){e.uploadButton.prop("disabled",!1),e.loadingSpinner.hide(),e.modalErrorMessage.removeClass("notice notice-error"),e.modalErrorMessage.addClass("notice notice-success"),e.modalErrorMessage.html("<p>"+s.data+"</p>"),e.messageModal.removeClass("hidden"),e.messageModal.addClass("not-hidden"),jQuery(".js-WpSmsImportStep1").css("display","none"),jQuery("#first-row-label").css("display","block"),e.uploadButton.hide(),e.importButton.show(),JSON.parse(i.getResponseHeader("X-FirstRow-content")).forEach((function(e){jQuery(".js-wpSmsGroupSelect").before('<tr class="js-wpSmsDataTypeRow"><td>'+e+'</td><td><span class="dashicons dashicons-arrow-right-alt"></span></td><td><select class="js-wpSmsImportColumnType"><option value="0">Please Select</option><option value="name">Name</option><option value="mobile">Mobile</option><option value="group">Group ID</option></select></td></tr>')}))}),1e3)},error:function(s,t,i){e.uploadButton.prop("disabled",!1),e.loadingSpinner.css("display","none"),e.modalErrorMessage.removeClass("notice notice-success"),e.modalErrorMessage.addClass("notice notice-error"),e.modalErrorMessage.html("<p>"+s.responseJSON.data+"</p>"),e.messageModal.removeClass("hidden"),e.messageModal.addClass("not-hidden")}})}.bind(this))},selectColumnFileHeaderEventListener:function(){jQuery("body").on("change",".js-wpSmsImportColumnType",(function(e){var s=!1;jQuery(".js-wpSmsImportColumnType").each((function(){"group"===jQuery(this).val()&&(s=!0)})),s?jQuery(".js-wpSmsGroupSelect").css("display","none"):jQuery(".js-wpSmsGroupSelect").css("display","block")}))},selectOrAddGroup:function(){jQuery("body").on("change",".js-wpSmsGroupSelect select",(function(e){"new_group"===jQuery(".js-wpSmsGroupSelect select").val()?jQuery(".js-wpSmsGroupName").css("display","block"):jQuery(".js-wpSmsGroupName").css("display","none")}))},disableSelectedOptions:function(){jQuery("body").on("change",".js-wpSmsImportColumnType",(function(e){var s=[];jQuery(".js-wpSmsImportColumnType").each((function(){var e=jQuery(this).val();"0"===e||s.includes(e)||s.push(e),jQuery(".js-wpSmsImportColumnType option").each((function(){s.includes(jQuery(this).val())||jQuery(this).attr("disabled",!1)})),jQuery(".js-wpSmsImportColumnType option").each((function(){s.includes(jQuery(this).val())&&jQuery(this).attr("disabled",!0)}))}))}))},bindImportRequestBody:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;e.importButton.on("click",(function(s){if(s.preventDefault(),jQuery(".js-wpSmsImportColumnType").each((function(s){if("0"!==jQuery(this).find("option:selected").val()){var t=jQuery(this).find("option:selected").val();e.requestBody[t]=s}})),!e.requestBody.group){var t=jQuery(".js-wpSmsGroupSelect select").val(),i=jQuery(".js-wpSmsSelectGroupName").val();switch(t){case"0":e.requestBody.state=0,e.requestBody.group=null;break;case"new_group":e.requestBody.state="new_group",e.requestBody.group=i;break;default:e.requestBody.state="existed_group",e.requestBody.group=t}}e.hasHeader.is(":checked")&&(e.requestBody.hasHeader=!0),jQuery("#TB_ajaxContent").animate({scrollTop:"0px"},300),e.importEventListener(0)}))},importEventListener:function(s){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;t.requestBody.startPoint=s,jQuery.ajax({url:wpSmsGlobalTemplateVar.ajaxUrls.importSubscriberCsv,method:"GET",data:t.requestBody,beforeSend:function(){t.uploadButton.attr("disabled","disabled"),t.loadingSpinner.css("display","flex")},success:function(s,i,n){var r,o=n.responseJSON.data.importDone,l=n.responseJSON.data.startPoint,a=n.responseJSON.data.count,d=n.responseJSON.data.errors;if(!o)for(var m=0,u=Object.entries(d);m<u.length;m++){var c=e(u[m],2),p=c[0],h=c[1];t.import_result[p]=h}if(n.responseJSON.data.successUpload&&(t.successUpload+=parseInt(n.responseJSON.data.successUpload)),!o)return t.importEventListener(l);switch(t.loadingSpinner.css("display","none"),t.importStep2.css("display","none"),t.importButton.css("display","none"),t.refreshButton.css("display","block"),t.messageModal.removeClass("hidden"),t.messageModal.addClass("not-hidden"),t.modalErrorMessage.removeClass("notice-error"),t.modalErrorMessage.addClass("notice-success"),t.successUpload){case a:r="<p>Subscribers have been imported successfully!</p>";break;case 0:t.modalErrorMessage.removeClass("notice-success"),t.modalErrorMessage.addClass("notice-error"),r="<p>Subscribers have not been imported. Look for errors in the logs.</p>";break;default:r="<p>"+t.successUpload+" of "+a+" subscribers have been imported successfully!</p>"}if(t.modalErrorMessage.html(r),!jQuery.isEmptyObject(t.import_result)){t.importResult.show();for(var f=0,b=Object.entries(t.import_result);f<b.length;f++){var y=e(b[f],2),_=y[0],w=y[1];t.importResultTable.append("<tr><td><code>"+_+"</code></td><td>"+w+"</td></tr>")}}},error:function(e){t.uploadButton.prop("disabled",!1),t.loadingSpinner.css("display","none"),t.messageModal.removeClass("hidden"),t.messageModal.addClass("not-hidden"),t.modalErrorMessage.removeClass("notice notice-success"),t.modalErrorMessage.addClass("notice notice-error"),t.modalErrorMessage.html("<p>"+e.responseJSON.data+"</p>")}})},refreshEventListener:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this).refreshButton.on("click",(function(e){e.preventDefault(),window.location.reload()}))}}})(),(()=>{jQuery(document).ready((function(o){e.init(),s.init(),t.init(),i.init(),jQuery("#subscribe-meta-box").length&&r.init(),jQuery("#wpcf7-contact-form-editor").length&&jQuery("#wpsms-tab").length&&n.init(),jQuery(".js-wpsms-chatbox-preview").length&&(jQuery(".wpsms-chatbox").hide(),o(".js-wpsms-chatbox-preview").click((function(e){e.preventDefault(),o(".wpsms-chatbox").fadeToggle()})));var l=o(".js-wpsms-select2"),a={placeholder:"Please select"};o(".js-wpSmsExportForm").length&&(a.dropdownParent=l.parent()),l.select2(a),o("#wpsms_settings\\[gateway_name\\]").on("change",(function(){o('input[name="submit"]').click()})),o(".wpsms-color-picker").length&&o(".wpsms-color-picker").wpColorPicker(),o(".repeater").length&&o(".repeater").repeater({initEmpty:!1,show:function(){o(this).slideDown();var e=o(this).find(".wpsms_settings_upload_field"),s=o(this).find(".wpsms_settings_upload_button");if(e.length&&s.length){var t=s.closest("[data-repeater-list]").children().length-1,i=e.attr("id")+"["+t+"]";e.attr("id",i),s.attr("data-target",i)}var n=o(this).find('[type="checkbox"]');if(n.length){var r=n.closest("[data-repeater-list]").children().length-1,l=n.attr("id")+"["+r+"]";n.attr("id",l),n.next().is("label")&&n.next().attr("for",l)}},hide:function(e){confirm("Are you sure you want to delete this item?")&&o(this).slideUp(e)},isFirstItemUndeletable:!0}),o(".wpsms-tooltip").length&&o(".wpsms-tooltip").tooltipster({theme:"tooltipster-flat",maxWidth:400}),o(document).on("click",".wpsms_settings_upload_button",(function(e){var s=wp.media({library:{type:"image"},multiple:!1});s.open(),s.on("select",(function(){var t=s.state().get("selection").first().toJSON();document.getElementById(e.target.dataset.target).value=t.url}))}))}));var e={getFields:function(){this.fields={internatioanlMode:{element:jQuery("#wpsms_settings\\[international_mobile\\]")},mobileMinimumChar:{element:jQuery("#wpsms_settings\\[mobile_terms_minimum\\]")},mobileMaximumChar:{element:jQuery("#wpsms_settings\\[mobile_terms_maximum\\]")},onlyCountries:{element:jQuery("#wpsms_settings\\[international_mobile_only_countries\\]")},preferredCountries:{element:jQuery("#wpsms_settings\\[international_mobile_preferred_countries\\]")},newsletterFormGroups:{element:jQuery("#wpsms_settings\\[newsletter_form_groups\\]")},newsletterFormMultipleSelect:{element:jQuery("#wpsms_settings\\[newsletter_form_multiple_select\\]")},newsletterFormSpecifiedGroups:{element:jQuery("#wpsms_settings\\[newsletter_form_specified_groups\\]")},newsletterFormDefaultGroup:{element:jQuery("#wpsms_settings\\[newsletter_form_default_group\\]")},mobileFieldStatus:{element:jQuery("#wpsms_settings\\[add_mobile_field\\]")},ultimateMemberFieldSelector:{element:jQuery("#wpsms_settings\\[um_sync_field_name\\]")},ultimateMemberSyncOldMembersField:{element:jQuery("#wpsms_settings\\[um_sync_previous_members\\]")},buddyPressFieldSelector:{element:jQuery("#wpsms_settings\\[bp_mobile_field_id\\]")},buddyPressSyncFields:{element:jQuery("#wpsms_settings\\[bp_sync_fields\\]")},pmproFieldSelector:{element:jQuery("#wpsms_settings\\[pmpro_mobile_field_id\\]")},onlyLocalNumbers:{element:jQuery("#wpsms_settings\\[send_only_local_numbers\\]")},onlyLocalNumbersCountries:{element:jQuery("#wpsms_settings\\[only_local_numbers_countries\\]")}}},hideOrShowFields:function(){this.fields.internatioanlMode.element.is(":checked")?(this.fields.onlyCountries.element.closest("tr").show(),this.fields.preferredCountries.element.closest("tr").show(),this.fields.mobileMinimumChar.element.closest("tr").hide(),this.fields.mobileMaximumChar.element.closest("tr").hide()):(this.fields.onlyCountries.element.closest("tr").hide(),this.fields.preferredCountries.element.closest("tr").hide(),this.fields.mobileMinimumChar.element.closest("tr").show(),this.fields.mobileMaximumChar.element.closest("tr").show()),this.fields.newsletterFormGroups.element.is(":checked")?(this.fields.newsletterFormMultipleSelect.element.closest("tr").show(),this.fields.newsletterFormSpecifiedGroups.element.closest("tr").show(),this.fields.newsletterFormDefaultGroup.element.closest("tr").show()):(this.fields.newsletterFormMultipleSelect.element.closest("tr").hide(),this.fields.newsletterFormSpecifiedGroups.element.closest("tr").hide(),this.fields.newsletterFormDefaultGroup.element.closest("tr").hide()),this.fields.onlyLocalNumbers.element.is(":checked")?this.fields.onlyLocalNumbersCountries.element.closest("tr").show():this.fields.onlyLocalNumbersCountries.element.closest("tr").hide()},addEventListener:function(){var e=this;["internatioanlMode","newsletterFormGroups","onlyLocalNumbers"].forEach((function(s){e.fields[s].element.on("change",(function(){e.hideOrShowFields()}))})),this.fields.mobileFieldStatus.element.on("change",function(){this.manageMobileFieldsVisibility()}.bind(this))},manageMobileFieldsVisibility:function(){var e=this.fields.mobileFieldStatus.element.val();switch(this.fields.buddyPressFieldSelector.element.closest("tr").hide(),this.fields.buddyPressSyncFields.element.closest("tr").hide(),this.fields.ultimateMemberFieldSelector.element.closest("tr").hide(),this.fields.ultimateMemberSyncOldMembersField.element.closest("tr").hide(),this.fields.pmproFieldSelector.element.closest("tr").hide(),e){case"use_ultimate_member_mobile_field":this.fields.ultimateMemberFieldSelector.element.closest("tr").show(),this.fields.ultimateMemberSyncOldMembersField.element.closest("tr").show();break;case"use_buddypress_mobile_field":this.fields.buddyPressFieldSelector.element.closest("tr").show(),this.fields.buddyPressSyncFields.element.closest("tr").show();break;case"use_current_field_in_pmpro":this.fields.pmproFieldSelector.element.closest("tr").show()}},init:function(){this.getFields(),this.hideOrShowFields(),this.addEventListener(),this.manageMobileFieldsVisibility()}},s={getFields:function(){this.fields={receiverField:{element:jQuery("#wpsms_settings\\[notif_publish_new_post_receiver\\]")},subscriberField:{element:jQuery("#wpsms_settings\\[notif_publish_new_post_default_group\\]")},numbersField:{element:jQuery("#wpsms_settings\\[notif_publish_new_post_numbers\\]")},usersField:{element:jQuery("#wpsms_settings\\[notif_publish_new_post_users\\]")}}},hideOrShowFields:function(){"subscriber"===this.fields.receiverField.element.val()?(this.fields.subscriberField.element.closest("tr").show(),this.fields.numbersField.element.closest("tr").hide(),this.fields.usersField.element.closest("tr").hide()):"numbers"===this.fields.receiverField.element.val()?(this.fields.subscriberField.element.closest("tr").hide(),this.fields.numbersField.element.closest("tr").show(),this.fields.usersField.element.closest("tr").hide()):"users"===this.fields.receiverField.element.val()&&(this.fields.subscriberField.element.closest("tr").hide(),this.fields.numbersField.element.closest("tr").hide(),this.fields.usersField.element.closest("tr").show())},addEventListener:function(){this.fields.receiverField.element.on("change",function(){this.hideOrShowFields()}.bind(this))},init:function(){this.getFields(),this.hideOrShowFields(),this.addEventListener()}},t={getFields:function(){this.fields={newProductSmsReceiverField:{element:jQuery("#wps_pp_settings\\[wc_notify_product_receiver\\]")},newProductSubscriberField:{element:jQuery("#wps_pp_settings\\[wc_notify_product_cat\\]")},newProductNumbersField:{element:jQuery("#wps_pp_settings\\[wc_notify_product_roles\\]")},checkoutMobileField:{element:jQuery("#wps_pp_settings\\[wc_mobile_field\\]")},mobileFieldNecessity:{element:jQuery("#wps_pp_settings\\[wc_mobile_field_optional\\]")}}},hideOrShowNewProductSmsReceiver:function(){"subscriber"===this.fields.newProductSmsReceiverField.element.val()?(this.fields.newProductSubscriberField.element.closest("tr").show(),this.fields.newProductNumbersField.element.closest("tr").hide()):(this.fields.newProductSubscriberField.element.closest("tr").hide(),this.fields.newProductNumbersField.element.closest("tr").show())},hideOrShowCheckoutMobileField:function(){"add_new_field"===this.fields.checkoutMobileField.element.val()?this.fields.mobileFieldNecessity.element.closest("tr").show():this.fields.mobileFieldNecessity.element.closest("tr").hide()},newProductSmsReceiverEventListener:function(){this.fields.newProductSmsReceiverField.element.on("change",function(){this.hideOrShowNewProductSmsReceiver()}.bind(this))},checkoutMobileFieldEventListener:function(){this.fields.checkoutMobileField.element.on("change",function(){this.hideOrShowCheckoutMobileField()}.bind(this))},init:function(){this.getFields(),this.hideOrShowNewProductSmsReceiver(),this.hideOrShowCheckoutMobileField(),this.newProductSmsReceiverEventListener(),this.checkoutMobileFieldEventListener()}},i={getFields:function(){this.fields={receiverField:{element:jQuery("#wps_pp_settings\\[job_notify_receiver\\]")},subscriberField:{element:jQuery("#wps_pp_settings\\[job_notify_receiver_subscribers\\]")},numbersField:{element:jQuery("#wps_pp_settings\\[job_notify_receiver_numbers\\]")}}},hideOrShowFields:function(){"subscriber"===this.fields.receiverField.element.val()?(this.fields.subscriberField.element.closest("tr").show(),this.fields.numbersField.element.closest("tr").hide()):(this.fields.subscriberField.element.closest("tr").hide(),this.fields.numbersField.element.closest("tr").show())},addEventListener:function(){this.fields.receiverField.element.on("change",function(){this.hideOrShowFields()}.bind(this))},init:function(){this.getFields(),this.hideOrShowFields(),this.addEventListener()}},n={init:function(){this.setFields(),this.hideOrShowFields(),this.addEventListener()},setFields:function(){this.fields={recipient:{element:jQuery("#wpcf7-sms-recipient")},recipient_numbers:{element:jQuery("#wp-sms-recipient-numbers")},recipient_groups:{element:jQuery("#wp-sms-recipient-groups")},message_body:{element:jQuery("#wp-sms-cf7-message-body")}}},hideOrShowFields:function(){"number"===this.fields.recipient.element.val()?(this.fields.recipient_numbers.element.show(),this.fields.recipient_groups.element.hide(),this.fields.message_body.element.show()):(this.fields.recipient_numbers.element.hide(),this.fields.recipient_groups.element.show(),this.fields.message_body.element.show())},addEventListener:function(){this.fields.recipient.element.on("change",function(){this.hideOrShowFields()}.bind(this))}},r={init:function(){this.setFields(),this.hideOrShowFields(),this.addEventListener(),this.insertShortcode()},setFields:function(){this.fields={recipient:{element:jQuery("#wps-send-to"),subscriber:{element:jQuery("#wpsms-select-subscriber-group")},numbers:{element:jQuery("#wpsms-select-numbers")},users:{element:jQuery("#wpsms-select-users")}},message_body:{element:jQuery("#wpsms-custom-text")},short_codes:{element:jQuery("#wpsms-short-codes")}}},hideOrShowFields:function(){"subscriber"===this.fields.recipient.element.val()?(this.fields.recipient.subscriber.element.show(),this.fields.recipient.numbers.element.hide(),this.fields.recipient.users.element.hide(),this.fields.message_body.element.show()):"numbers"===this.fields.recipient.element.val()?(this.fields.recipient.subscriber.element.hide(),this.fields.recipient.numbers.element.show(),this.fields.recipient.users.element.hide(),this.fields.message_body.element.show()):"users"===this.fields.recipient.element.val()?(this.fields.recipient.subscriber.element.hide(),this.fields.recipient.numbers.element.hide(),this.fields.recipient.users.element.show(),this.fields.message_body.element.show()):(this.fields.recipient.subscriber.element.hide(),this.fields.recipient.numbers.element.hide(),this.fields.recipient.users.element.hide(),this.fields.message_body.element.hide())},addEventListener:function(){this.fields.recipient.element.on("change",function(){this.hideOrShowFields()}.bind(this))},insertShortcode:function(){this.fields.short_codes.element.find("code").each((function(e){jQuery(this).on("click",(function(){var e=" "+jQuery(this).text()+" ";jQuery("#wpsms-text-template").val((function(s,t){var i=jQuery(this)[0].selectionStart;return t.substring(0,i)+e+t.substring(i)}))}))}))}}})(),(()=>{jQuery(document).ready((function(s){e.init()}));var e={init:function(){this.setElements(),this.checkIfTwoWayIsActive(),this.showTwoWayModalIfNotActive(),this.calculateCounts(),this.initChart(),this.addEventListener()},setElements:function(){this.elements={context:jQuery(".wp-sms-widgets.stats-widget .chart canvas"),timeFrameSelect:jQuery(".wp-sms-widgets.stats-widget select.time-frame"),smsDirection:jQuery(".wp-sms-widgets.stats-widget select.sms-direction"),totalsDiv:jQuery(".wp-sms-widgets.stats-widget table.totals tr"),twoWayPromotion:jQuery(".wp-sms-widgets.stats-widget .two-way-promotion")}},checkIfTwoWayIsActive:function(){void 0===WP_Sms_Dashboard_Widget_Stats_Script_Object["received-messages-stats"]&&(this.twoWayIsNotActive=!0,WP_Sms_Dashboard_Widget_Stats_Script_Object["received-messages-stats"]=WP_Sms_Dashboard_Widget_Stats_Script_Object["send-messages-stats"])},showTwoWayModalIfNotActive:function(){"received-messages-stats"==this.elements.smsDirection.val()&&1==this.twoWayIsNotActive?(this.elements.twoWayPromotion.show(),this.elements.totalsDiv.addClass("blur"),this.elements.context.addClass("blur")):(this.elements.twoWayPromotion.hide(),this.elements.totalsDiv.removeClass("blur"),this.elements.context.removeClass("blur"))},getChartData:function(){var e=this.elements.timeFrameSelect.val(),s=this.elements.smsDirection.val(),t=WP_Sms_Dashboard_Widget_Stats_Script_Object[s][e],i=WP_Sms_Dashboard_Widget_Stats_Script_Object.localization;switch(s){case"send-messages-stats":return{datasets:[{label:i.successful,backgroundColor:"rgba(0, 190, 86, 0.4)",borderColor:"rgba(0, 148, 67, 1)",borderWidth:1,fill:!0,data:t.successful,tension:.4},{label:i.failed,backgroundColor:"rgba(255, 99, 132, 0.5)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1,fill:!0,data:t.failure,tension:.4}]};case"received-messages-stats":return{datasets:[{label:i.successful,backgroundColor:"rgba(0, 190, 86, 0.4)",borderColor:"rgba(0, 148, 67, 1)",borderWidth:1,fill:!0,data:t.successful,tension:.4},{label:i.failed,backgroundColor:"rgba(255, 99, 132, 0.4)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1,fill:!0,data:t.failure,tension:.4},{label:i.plain,backgroundColor:"rgba(156, 156, 156, 0.3)",borderColor:"rgb(73, 80, 87)",borderWidth:1,fill:!0,data:t.plain,tension:.4}]}}},calculateCounts:function(){var e,s=this.elements.timeFrameSelect.val(),t=this.elements.smsDirection.val(),i=WP_Sms_Dashboard_Widget_Stats_Script_Object[t][s],n=WP_Sms_Dashboard_Widget_Stats_Script_Object.localization,r={};for(var o in i)Object.hasOwnProperty.call(i,o)&&function(){var e=i[o];r[o]=Object.keys(e).reduce((function(s,t){return s+parseFloat(e[t]||0)}),0)}();switch(t){case"send-messages-stats":this.elements.totalsDiv.html("\n                        <td class='successful'>\n                            <img src=\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='96px' height='96px' viewBox='0 0 96 96' enable-background='new 0 0 96 96' xml:space='preserve'%3E%3Cg%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' fill='%236BBE66' d='M48,0c26.51,0,48,21.49,48,48S74.51,96,48,96S0,74.51,0,48 S21.49,0,48,0L48,0z M26.764,49.277c0.644-3.734,4.906-5.813,8.269-3.79c0.305,0.182,0.596,0.398,0.867,0.646l0.026,0.025 c1.509,1.446,3.2,2.951,4.876,4.443l1.438,1.291l17.063-17.898c1.019-1.067,1.764-1.757,3.293-2.101 c5.235-1.155,8.916,5.244,5.206,9.155L46.536,63.366c-2.003,2.137-5.583,2.332-7.736,0.291c-1.234-1.146-2.576-2.312-3.933-3.489 c-2.35-2.042-4.747-4.125-6.701-6.187C26.993,52.809,26.487,50.89,26.764,49.277L26.764,49.277z'/%3E%3C/g%3E%3C/svg%3E\">\n                            ".concat(r.successful," ").concat(n.successful,"\n                        </td>\n                        <td class='failure'>\n                            <img src=\"data:image/svg+xml,%3Csvg id='Layer_1' data-name='Layer 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 122.88 122.88'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23eb0100;%7D.cls-1,.cls-2%7Bfill-rule:evenodd;%7D.cls-2%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3Ecancel%3C/title%3E%3Cpath class='cls-1' d='M61.44,0A61.44,61.44,0,1,1,0,61.44,61.44,61.44,0,0,1,61.44,0Z'/%3E%3Cpath class='cls-2' d='M35.38,49.72c-2.16-2.13-3.9-3.47-1.19-6.1l8.74-8.53c2.77-2.8,4.39-2.66,7,0L61.68,46.86,73.39,35.15c2.14-2.17,3.47-3.91,6.1-1.2L88,42.69c2.8,2.77,2.66,4.4,0,7L76.27,61.44,88,73.21c2.65,2.58,2.79,4.21,0,7l-8.54,8.74c-2.63,2.71-4,1-6.1-1.19L61.68,76,49.9,87.81c-2.58,2.64-4.2,2.78-7,0l-8.74-8.53c-2.71-2.63-1-4,1.19-6.1L47.1,61.44,35.38,49.72Z'/%3E%3C/svg%3E\">\n                            ").concat(r.failure," ").concat(n.failed,"\n                        </td>\n                    "));break;case"received-messages-stats":this.elements.totalsDiv.html("\n                        <td class='successful'>\n                            <img src=\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='96px' height='96px' viewBox='0 0 96 96' enable-background='new 0 0 96 96' xml:space='preserve'%3E%3Cg%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' fill='%236BBE66' d='M48,0c26.51,0,48,21.49,48,48S74.51,96,48,96S0,74.51,0,48 S21.49,0,48,0L48,0z M26.764,49.277c0.644-3.734,4.906-5.813,8.269-3.79c0.305,0.182,0.596,0.398,0.867,0.646l0.026,0.025 c1.509,1.446,3.2,2.951,4.876,4.443l1.438,1.291l17.063-17.898c1.019-1.067,1.764-1.757,3.293-2.101 c5.235-1.155,8.916,5.244,5.206,9.155L46.536,63.366c-2.003,2.137-5.583,2.332-7.736,0.291c-1.234-1.146-2.576-2.312-3.933-3.489 c-2.35-2.042-4.747-4.125-6.701-6.187C26.993,52.809,26.487,50.89,26.764,49.277L26.764,49.277z'/%3E%3C/g%3E%3C/svg%3E\">\n                            ".concat(r.successful," ").concat(n.successful,"\n                        </td>\n                        <td class='failure'>\n                            <img src=\"data:image/svg+xml,%3Csvg id='Layer_1' data-name='Layer 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 122.88 122.88'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23eb0100;%7D.cls-1,.cls-2%7Bfill-rule:evenodd;%7D.cls-2%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Ctitle%3Ecancel%3C/title%3E%3Cpath class='cls-1' d='M61.44,0A61.44,61.44,0,1,1,0,61.44,61.44,61.44,0,0,1,61.44,0Z'/%3E%3Cpath class='cls-2' d='M35.38,49.72c-2.16-2.13-3.9-3.47-1.19-6.1l8.74-8.53c2.77-2.8,4.39-2.66,7,0L61.68,46.86,73.39,35.15c2.14-2.17,3.47-3.91,6.1-1.2L88,42.69c2.8,2.77,2.66,4.4,0,7L76.27,61.44,88,73.21c2.65,2.58,2.79,4.21,0,7l-8.54,8.74c-2.63,2.71-4,1-6.1-1.19L61.68,76,49.9,87.81c-2.58,2.64-4.2,2.78-7,0l-8.74-8.53c-2.71-2.63-1-4,1.19-6.1L47.1,61.44,35.38,49.72Z'/%3E%3C/svg%3E\">\n                            ").concat(r.failure," ").concat(n.failed,"\n                        </td>\n                        <td class='plain'>\n                            <img src=\"data:image/svg+xml,%3Csvg id='Layer_1' data-name='Layer 1' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 121.86 122.88'%3E%3Ctitle%3Ecomment%3C/title%3E%3Cpath d='M30.28,110.09,49.37,91.78A3.84,3.84,0,0,1,52,90.72h60a2.15,2.15,0,0,0,2.16-2.16V9.82a2.16,2.16,0,0,0-.64-1.52A2.19,2.19,0,0,0,112,7.66H9.82A2.24,2.24,0,0,0,7.65,9.82V88.55a2.19,2.19,0,0,0,2.17,2.16H26.46a3.83,3.83,0,0,1,3.82,3.83v15.55ZM28.45,63.56a3.83,3.83,0,1,1,0-7.66h53a3.83,3.83,0,0,1,0,7.66Zm0-24.86a3.83,3.83,0,1,1,0-7.65h65a3.83,3.83,0,0,1,0,7.65ZM53.54,98.36,29.27,121.64a3.82,3.82,0,0,1-6.64-2.59V98.36H9.82A9.87,9.87,0,0,1,0,88.55V9.82A9.9,9.9,0,0,1,9.82,0H112a9.87,9.87,0,0,1,9.82,9.82V88.55A9.85,9.85,0,0,1,112,98.36Z'/%3E%3C/svg%3E\">\n                            ").concat(null!==(e=r.plain)&&void 0!==e?e:0," ").concat(n.plain,"\n                        </td>\n                    "))}},addEventListener:function(){var e=function(){this.showTwoWayModalIfNotActive();var e=this.chart;e.data=this.getChartData(),this.calculateCounts(),e.update()}.bind(this);this.elements.timeFrameSelect.on("change",e),this.elements.smsDirection.on("change",e)},initChart:function(){var e=this.elements.context.get(0);this.chart=new Chart(e,{type:"line",data:this.getChartData(),options:{tooltips:{mode:"index"},interaction:{intersect:!1},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})}}})(),(()=>{jQuery(document).ready((function(){e.init()}));var e={init:function(){this.setFields(),this.addEventListener()},setFields:function(){this.exportForm=jQuery(".js-wpSmsExportForm"),this.exportGroup=jQuery("#wpsms_groups")},addEventListener:function(){this.exportForm.on("submit",function(e){e.preventDefault();var s=jQuery(".wp-sms-export-type").val(),t={type:s};"subscriber"==s&&Object.assign(t,{groupIds:this.exportGroup.val()}),jQuery.ajax({url:wpSmsGlobalTemplateVar.ajaxUrls.export,type:"GET",xhrFields:{responseType:"blob"},contentType:"application/json",data:t,beforeSend:function(){jQuery(".js-wpSmsExportButton").attr("disabled","disabled"),jQuery(".wpsms-sendsms__overlay").css("display","flex")},success:function(e,s,t){jQuery(".js-wpSmsExportButton").prop("disabled",!1),jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").removeClass("notice notice-error"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").addClass("notice notice-success"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").html("<p>The data exported successfully.</p>");var i=t.getResponseHeader("Content-Disposition");i=i.slice(i.indexOf("filename")+9);var n=window.URL.createObjectURL(e),r=window.URL,o=document.createElement("a");void 0===o.download?window.location.href=n:(o.href=n,o.download=i,document.body.appendChild(o),o.click()),setTimeout((function(){r.revokeObjectURL(n)}),100)},error:function(e,s,t){jQuery(".js-wpSmsExportButton").prop("disabled",!1),jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").removeClass("notice notice-success"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").addClass("notice notice-error"),jQuery(".wpsms-export-popup .wp-sms-popup-messages").html("<p>Failed to export the data.</p>")}})}.bind(this))}}})(),(()=>{function e(){jQuery("html, body").animate({scrollTop:0},1e3)}jQuery(document).ready((function(){function t(){var e=jQuery("#select_sender").find("option:selected").text();jQuery(".preview__message__receiver").text(e)}function i(){jQuery(".wpsms-sendsms-result").fadeOut()}s.init(),jQuery("#wp_get_message").counter({count:"up",goal:"sky",msg:WpSmsSendSmsTemplateVar.messageMsg}),WpSmsSendSmsTemplateVar.proIsActive&&(jQuery("#datepicker").flatpickr({enableTime:!0,dateFormat:"Y-m-d H:i:00",time_24hr:!0,minuteIncrement:"10",minDate:WpSmsSendSmsTemplateVar.currentDateTime,disableMobile:!0,defaultDate:WpSmsSendSmsTemplateVar.currentDateTime}),jQuery("#schedule_status").on("change",(function(){jQuery(this).is(":checked")?jQuery("#schedule_date").show():jQuery("#schedule_date").hide()}))),jQuery(".preview__message__number").html(jQuery("#wp_get_sender").val()),jQuery("#wp_get_message").val()&&jQuery(".preview__message__message").html(jQuery("#wp_get_message").val()),jQuery("#wp_get_sender").on("keyup",(function(){jQuery(".preview__message__number").html(jQuery("#wp_get_sender").val())})),jQuery("#wp_get_message").on("keyup",(function(){jQuery(".preview__message__message-wrapper").scrollTop(jQuery(".preview__message__message").height());var e,s,t=jQuery("#wp_get_message").val().replace(/(\r\n|\n|\r)/gm,"<br>");jQuery(".preview__message__message").html(t),e="#wp_get_message",s=".preview__message__message",jQuery(e).off("keypress").on("keypress",(function(t){setTimeout((function(){if(!(jQuery(e).val().length>1)){var i=/[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(String.fromCharCode(t.which)),n=i?"rtl":"ltr";jQuery(e).css({direction:n}),i?jQuery(s).css({direction:"rtl"}):jQuery(s).css({direction:"ltr"})}}))}))})),t(),jQuery("#select_sender").on("change",(function(){t()})),jQuery('button[name="SendSMS"]').on("click",(function(t){t.preventDefault(),function(){var t=jQuery("#wp_get_sender").val(),i={type:jQuery("select[name='wp_send_to'] option:selected").val()},n=jQuery("#wp_get_message").val(),r=jQuery(".wpsms-mms-image").val(),o={scheduled:jQuery("#schedule_status").is(":checked")},l=s.getData(),a=jQuery('[name="wp_flash"]:checked').val();"subscribers"===i.type?i.groups=jQuery('.wpsms-group select[name="wpsms_groups[]"]').val():"roles"===i.type?i.roles=jQuery('select[name="wpsms_roles[]"]').val():"users"===i.type?i.users=jQuery('select[name="wpsms_users[]"]').val():"numbers"===i.type&&(i.numbers=jQuery('textarea[name="wp_get_number"]').val(),i.numbers=i.numbers.replace(/\n/g,",").split(",")),o.scheduled&&(o.date=jQuery("#datepicker").val());var d={sender:t,recipients:i.type,group_ids:i.groups,role_ids:i.roles,users:i.users,message:n,numbers:i.numbers,flash:a,media_urls:[r],schedule:o.date,repeat:l};d=wp.hooks.applyFilters("wp_sms_send_request_body",d),jQuery(".wpsms-sendsms-result").fadeOut(),jQuery.ajax(wpSmsGlobalTemplateVar.restUrls.sendSms,{headers:{"X-WP-Nonce":WpSmsSendSmsTemplateVar.nonce},dataType:"json",type:"post",contentType:"application/json",data:JSON.stringify(d),beforeSend:function(){jQuery(".wpsms-sendsms__overlay").css("display","flex"),jQuery('button[name="SendSMS"]').fadeOut()},success:function(s,t,n){Object.keys(i).forEach((function(e){delete i[e]})),jQuery(".wpsms-remove-button").trigger("click"),jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery(".wpsms-sendsms-result").removeClass("error"),jQuery(".wpsms-sendsms-result").addClass("success"),jQuery(".wpsms-sendsms-result p").html(s.message),jQuery("#wpsms_account_credit").html(s.data.balance),jQuery(".wpsms-sendsms-result").fadeIn(),jQuery("#SendSMSAgain").fadeIn(),e()},error:function(s,t,i){jQuery(".wpsms-sendsms-result").removeClass("success"),jQuery(".wpsms-sendsms-result").addClass("error"),jQuery(".wpsms-sendsms-result p").html(s.responseJSON.error.message),jQuery(".wpsms-sendsms-result").fadeIn(),jQuery(".wpsms-sendsms__overlay").css("display","none"),jQuery('button[name="SendSMS"]').removeClass("inactive"),e()}})}()})),jQuery("#SendSMSAgain").on("click",(function(){jQuery(".sendsms-content .summary").fadeOut(),jQuery("#content").trigger("click"),jQuery('button[name="SendSMS"]').removeClass("inactive"),i()})),jQuery(".sendsms-content .previous-button").on("click",i),jQuery(".sendsms-content .next-button").on("click",i),jQuery(".sendsms-tabs .tab").on("click",i);var n=jQuery(".wpsms-upload-button"),r=jQuery(".wpsms-remove-button"),o=jQuery(".wpsms-mms-image");n.on("click",(function(e){e.preventDefault();var s=jQuery(this),t=wp.media({title:"Insert image",library:{type:["image"]},button:{text:"Use this image"},multiple:!1}).on("select",(function(){var e=t.state().get("selection").first().toJSON();s.html('<img width="300" src="'+e.url+'">'),o.val(e.url),r.show()})).open()})),r.on("click",(function(e){e.preventDefault(),jQuery(this).hide(),o.val(""),n.html("Upload image")})),{getFields:function(){this.fields={contentTab:{element:jQuery(".wpsms-sendsms .tab#content")},receiverTab:{element:jQuery(".wpsms-sendsms .tab#receiver")},optionsTab:{element:jQuery(".wpsms-sendsms .tab#options")},sendTab:{element:jQuery(".wpsms-sendsms .tab#send")},allTab:{element:jQuery(".wpsms-sendsms .tab")},fromField:{element:jQuery(".wpsms-sendsms .sendsms-content .from-field")},toField:{element:jQuery(".wpsms-sendsms .sendsms-content .to-field")},groupField:{element:jQuery(".wpsms-sendsms .sendsms-content .wpsms-group-field")},usersField:{element:jQuery(".wpsms-sendsms .sendsms-content .wpsms-users-field")},searchUserField:{element:jQuery(".wpsms-sendsms .sendsms-content .wpsms-search-user-field")},numbersField:{element:jQuery(".wpsms-sendsms .sendsms-content .wpsms-numbers-field")},bulkField:{element:jQuery(".wpsms-sendsms .sendsms-content .bulk-field")},contentField:{element:jQuery(".wpsms-sendsms .sendsms-content .content-field")},mmsMediaField:{element:jQuery(".wpsms-sendsms .sendsms-content .mms-media-field")},scheduleField:{element:jQuery(".wpsms-sendsms .sendsms-content .schedule-field")},setDateField:{element:jQuery(".wpsms-sendsms .sendsms-content .set-date-field")},repeatField:{element:jQuery(".wpsms-sendsms .sendsms-content .repeat-field")},repeatEveryField:{element:jQuery(".wpsms-sendsms .sendsms-content .repeat-every-field")},repeatEndField:{element:jQuery(".wpsms-sendsms .sendsms-content .repeat-end-field")},flashField:{element:jQuery(".wpsms-sendsms .sendsms-content .flash-field")},summary:{element:jQuery(".wpsms-sendsms .sendsms-content .summary")},submitButton:{element:jQuery(".wpsms-sendsms .sendsms-content .sendsms-button")},sendAgainButton:{element:jQuery(".wpsms-sendsms .sendsms-content .sendsms-again-button")},nextButton:{element:jQuery("#wpbody-content .next-button")},prevButton:{element:jQuery("#wpbody-content .previous-button")}}},addEventListener:function(){var e=this;e.manageNavigationKeys(),e.fields.allTab.element.on("click",(function(){e.fields.allTab.element.removeClass("active passed"),jQuery(this).addClass("active"),jQuery(this).prevAll().addClass("passed"),e.manageFieldsVisibility(),e.manageNavigationKeys()})),e.fields.nextButton.element.on("click",(function(){var s=jQuery(".wpsms-sendsms .tab.active").next(".tab");s.length>0&&(e.fields.allTab.element.removeClass("active passed"),s.addClass("active"),s.prevAll().addClass("passed"),e.manageFieldsVisibility()),e.manageNavigationKeys()})),e.fields.prevButton.element.on("click",(function(){var s=jQuery(".wpsms-sendsms .tab.active").prev(".tab");s.length>0&&(e.fields.allTab.element.removeClass("active passed"),s.addClass("active"),s.prevAll().addClass("passed"),e.manageFieldsVisibility()),e.manageNavigationKeys()})),e.fields.toField.element.find("select").on("change",(function(){e.manageRecipients()})),e.fields.scheduleField.element.find('input[type="checkbox"]').on("change",(function(){e.manageProOptions()})),e.fields.repeatField.element.find('input[type="checkbox"]').on("change",(function(){e.manageProOptions()}))},manageProOptions:function(){var e=jQuery(".wpsms-sendsms .tab.active").attr("id"),s=jQuery("#schedule_status").is(":checked"),t=jQuery("#wpsms_repeat_status").is(":checked");"options"==e&&s?(this.fields.setDateField.element.fadeIn(),this.fields.repeatField.element.fadeIn()):(this.fields.setDateField.element.hide(),this.fields.repeatField.element.hide()),"options"==e&&s&&t?(this.fields.repeatEveryField.element.fadeIn(),this.fields.repeatEndField.element.fadeIn()):(this.fields.repeatEveryField.element.hide(),this.fields.repeatEndField.element.hide())},manageNavigationKeys:function(){var e=jQuery(".wpsms-sendsms .tab.active"),s=(e.prev(".tab"),e.prevAll());e.next(".tab"),e.nextAll().length<1?this.fields.nextButton.element.addClass("inactive"):this.fields.nextButton.element.removeClass("inactive"),s.length<1?this.fields.prevButton.element.addClass("inactive"):this.fields.prevButton.element.removeClass("inactive")},manageFieldsVisibility:function(){for(var e=jQuery(".wpsms-sendsms .tab.active").attr("id"),s=0,t=[this.fields.fromField,this.fields.toField,this.fields.searchUserField,this.fields.groupField,this.fields.usersField,this.fields.numbersField,this.fields.bulkField,this.fields.contentField,this.fields.mmsMediaField,this.fields.scheduleField,this.fields.setDateField,this.fields.repeatField,this.fields.repeatEveryField,this.fields.repeatEndField,this.fields.flashField,this.fields.summary,this.fields.submitButton,this.fields.sendAgainButton];s<t.length;s++)t[s].element.hide();switch(this.fields.submitButton.element.prop("disabled",!0),e){case"content":this.fields.contentField.element.fadeIn();break;case"receiver":this.fields.fromField.element.fadeIn(),this.fields.toField.element.fadeIn(),this.manageRecipients();break;case"options":this.fields.bulkField.element.fadeIn(),this.fields.mmsMediaField.element.fadeIn(),this.fields.scheduleField.element.fadeIn(),this.fields.flashField.element.fadeIn(),this.manageProOptions();break;case"send":this.fields.summary.element.fadeIn(),this.fields.submitButton.element.fadeIn(),this.fields.submitButton.element.prop("disabled",!1)}},manageRecipients:function(){var e=jQuery(".wpsms-sendsms .tab.active").attr("id"),s=this.fields.toField.element.find("select option:selected").attr("id");if("receiver"===e)switch(jQuery(".wpsms-value").hide(),s){case"wp_subscribe_username":jQuery(".wpsms-group").fadeIn();break;case"wp_roles":jQuery(".wpsms-roles").fadeIn();break;case"wp_users":jQuery(".wpsms-users").fadeIn();break;case"wc_users":jQuery(".wpsms-wc-users").fadeIn();break;case"bp_users":jQuery(".wpsms-bp-users").fadeIn(),jQuery(".wpsms-search-user-field").fadeIn();break;case"wp_tellephone":jQuery(".wpsms-numbers").fadeIn(),jQuery("#wp_get_number").focus();break;case"wp_role":jQuery(".wprole-group").fadeIn()}},addSearchUserEventListener:function(){var e=[],s=jQuery(".wpsms-sendsms .wpsms-search-user select.js-wpsms-select2");s.on("select2:select",(function(s){var t=s.params.data;t&&-1==e.findIndex((function(e){return e.id==t.id}))&&e.push(t)})),s.on("select2:unselect",(function(s){var t=s.params.data;if(t){var i=e.findIndex((function(e){return e.id==t.id}));-1!==i&&e.splice(i,1)}})),s.select2({ajax:{url:wpSmsGlobalTemplateVar.restUrls.users,method:"GET",dataType:"json",headers:{"X-WP-Nonce":WpSmsSendSmsTemplateVar.nonce},data:function(e){return{search:e.term}},processResults:function(s){var t=[];return s.forEach((function(s){s.id&&s.id>0&&(optionTitle=s.slug+" ( "+s.name+" )",-1==e.findIndex((function(e){return e.id==s.id}))&&t.push({id:s.id,text:optionTitle}))})),{results:t}}},templateResult:function(e){return jQuery("<span>"+e.text+"</span>")},escapeMarkup:function(e){return e}})},init:function(){this.getFields(),this.addEventListener(),this.addSearchUserEventListener(),this.manageFieldsVisibility()}}.init()}));var s={init:function(){WpSmsSendSmsTemplateVar.proIsActive&&(this.setElements(),this.initElements(),this.handleFieldsVisibility(),this.handleEndDateField())},setElements:function(){this.elements={statusCheckbox:jQuery("#wpsms_repeat_status"),parentCheckbox:jQuery("#schedule_status"),subFields:jQuery(".repeat-subfield"),repeatInterval:jQuery("#repeat-interval"),repeatUnit:jQuery("#repeat-interval-unit"),endDatepicker:jQuery("#repeat_ends_on"),foreverCheckbox:jQuery("#repeat-forever")}},initElements:function(){this.elements.endDatepicker.flatpickr({enableTime:!0,dateFormat:"Y-m-d H:i:00",time_24hr:!0,minuteIncrement:"10",minDate:WpSmsSendSmsTemplateVar.currentDateTime,disableMobile:!0,defaultDate:WpSmsSendSmsTemplateVar.currentDateTime})},handleFieldsVisibility:function(){var e=function(){this.elements.parentCheckbox.is(":checked")?this.elements.statusCheckbox.closest("tr").show():this.elements.statusCheckbox.closest("tr").hide(),this.elements.parentCheckbox.is(":checked")&&this.elements.statusCheckbox.is(":checked")?(this.elements.subFields.show(),this.isActive=!0):(this.elements.subFields.hide(),this.isActive=!1)}.bind(this);e(),this.elements.statusCheckbox.on("change",e),this.elements.parentCheckbox.on("change",e)},handleEndDateField:function(){var e=function(){this.elements.foreverCheckbox.is(":checked")?this.elements.endDatepicker.attr("disabled","disabled"):this.elements.endDatepicker.prop("disabled",!1)}.bind(this);e(),this.elements.foreverCheckbox.on("change",e)},getData:function(){if(this.isActive){var e=this.elements,s={interval:{value:e.repeatInterval.val(),unit:e.repeatUnit.val()}};return e.foreverCheckbox.is(":checked")?s.repeatForever=!0:s.endDate=e.endDatepicker.val(),s}}}})(),(()=>{jQuery(document).ready((function(){e.init()}));var e={elements:{},init:function(){this.elements.form=jQuery(".wpsms-privacyPage__Form"),this.elements.form.find("input[type=submit]").on("click",(function(e){e.preventDefault();var s=e.target.name,t=jQuery(e.target).closest("div").find('input[type="tel"]').val(),i=new FormData;i.append("mobileNumber",t),i.append("type",s),jQuery.ajax({url:wp_sms_privacy_page_ajax_vars.url,method:"POST",contentType:!1,cache:!1,processData:!1,data:i,beforeSend:function(){jQuery(".wpsms-privacyPage__Result__Container").hide(),jQuery(".wpsms-privacyPage__Result__Container").empty()},success:function(e,s,t){e.data.file_url&&(window.open(e.data.file_url),jQuery(".wpsms-privacyPage__Result__Container").html(e.data.message)),jQuery(".wpsms-privacyPage__Result__Container").html(e.data.message),jQuery(".wpsms-privacyPage__Result__Container").show()},error:function(e,s,t){jQuery(".wpsms-privacyPage__Result__Container").html(e.responseJSON.data.message),jQuery(".wpsms-privacyPage__Result__Container").show()}})}))}}})(),(()=>{jQuery(document).ready((function(){e.init()}));var e={init:function(){this.setFields(),this.addSendSMSEventListeners(),this.addNoteEventListeners(),this.setupNotesMetabox()},setFields:function(){this.SmsMetabox=jQuery("#wpsms-woocommerceSendSMS"),this.NotesMetabox=jQuery("#woocommerce-order-notes")},sendSMS:function(){var e=this.SmsMetabox.find('select[name="phone_number"]').val(),s=this.SmsMetabox.find('textarea[name="message_content"]').val(),t=wpSmsWooCommerceTemplateVar.order_id,i={message:s,recipients:"numbers",numbers:[e],notification_handler:"WooCommerceOrderNotification",handler_id:t,sender:wpSmsWooCommerceTemplateVar.sender_id};jQuery.ajax(wpSmsWooCommerceTemplateVar.rest_urls.send_sms,{headers:{"X-WP-Nonce":wpSmsWooCommerceTemplateVar.nonce},dataType:"json",type:"post",contentType:"application/json",data:JSON.stringify(i),beforeSend:function(){this.SmsMetabox.find(".wpsms-orderSmsMetabox__overlay").css("display","flex"),this.SmsMetabox.find(".wpsms-orderSmsMetabox__variables__shortCodes").slideUp(),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__tryAgain").hide()}.bind(this),success:function(t,i,n){this.SmsMetabox.find(".wpsms-orderSmsMetabox").fadeOut(),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report p").html(t.message),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report").removeClass("error"),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report").addClass("success"),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__receiver p").html(e),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__message p").html(s),this.SmsMetabox.find(" .wpsms-orderSmsMetabox__result").fadeIn()}.bind(this),error:function(e,s,t){var i=e.responseJSON.message?e.responseJSON.message:e.responseJSON.error.message;this.SmsMetabox.find(".wpsms-orderSmsMetabox").fadeOut(),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report").removeClass("success"),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report").addClass("error"),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__report p").html(i),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__tryAgain").show(),this.SmsMetabox.find(".wpsms-orderSmsMetabox__result").fadeIn()}.bind(this)})},addSendSMSEventListeners:function(){var e=this;this.SmsMetabox.find(".wpsms-orderSmsMetabox__result__tryAgain").on("click",(function(s){s.preventDefault(),e.SmsMetabox.find(".wpsms-orderSmsMetabox__result").fadeOut(),e.SmsMetabox.find(".wpsms-orderSmsMetabox__overlay").css("display","none"),e.SmsMetabox.find(".wpsms-orderSmsMetabox").fadeIn()})),this.SmsMetabox.find('button[name="send_sms"]').on("click",(function(s){s.preventDefault(),e.sendSMS()})),this.SmsMetabox.find(".wpsms-orderSmsMetabox__variables__shortCodes code").on("click",(function(){var e=jQuery(this).text(),s=document.getElementById("message_content"),t=s.selectionStart,i=s.value.substring(0,t),n=s.value.substring(t);e=" "+e,s.value=i+e+n,s.setSelectionRange(t+e.length,t+e.length)})),this.SmsMetabox.find(".wpsms-orderSmsMetabox__variables__header").on("click",(function(){jQuery(this).next(".wpsms-orderSmsMetabox__variables__shortCodes").slideToggle(),jQuery(this).find(".wpsms-orderSmsMetabox__variables__icon").toggleClass("expanded")}))},addNoteEventListeners:function(){var e=this;this.NotesMetabox.find("button.add_note").on("click",(function(s){e.sendNoteSMS()})),this.NotesMetabox.find("select[name=order_note_type]").on("change",(function(){var s=e.NotesMetabox.find("select[name=order_note_type]").val();e.NotesMetabox.find(".wpsms-addNoteMetabox__elements").toggle("customer"===s)}))},setupNotesMetabox:function(){jQuery("#woocommerce-order-notes div.add_note").append('<div class="wpsms-addNoteMetabox__elements"><label for="wpsms_note_send"><input type="checkbox" id="wpsms_note_send" name="wpsms_note_send">'+wpSmsWooCommerceTemplateVar.lang.checkbox_label+'</label><div class="wpsms-addNoteMetabox__result__report"><span class="wpsms-addNoteMetabox__result__icon"></span><p></p></div></div>')},sendNoteSMS:function(){var e=this.NotesMetabox.find("textarea[name=order_note]").val(),s=this.NotesMetabox.find("input[name=wpsms_note_send]").prop("checked"),t=this.NotesMetabox.find("select[name=order_note_type]").val(),i=wpSmsWooCommerceTemplateVar.receiver,n=wpSmsWooCommerceTemplateVar.order_id;if(s&&e&&"customer"===t){var r={message:e,recipients:"numbers",numbers:[i],notification_handler:"WooCommerceOrderNotification",handler_id:n,sender:wpSmsWooCommerceTemplateVar.sender_id};jQuery.ajax(wpSmsWooCommerceTemplateVar.rest_urls.send_sms,{headers:{"X-WP-Nonce":wpSmsWooCommerceTemplateVar.nonce},dataType:"json",type:"post",contentType:"application/json",data:JSON.stringify(r),beforeSend:function(){this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report").removeClass("error success"),this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report").fadeOut()}.bind(this),success:function(e,s,t){this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report p").html(e.message),this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report").addClass("success"),this.NotesMetabox.find(" .wpsms-addNoteMetabox__result__report").fadeIn()}.bind(this),error:function(e,s,t){var i=e.responseJSON.message?e.responseJSON.message:e.responseJSON.error.message;this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report").addClass("error"),this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report p").html(i),this.NotesMetabox.find(".wpsms-addNoteMetabox__result__report").fadeIn()}.bind(this)})}}}})();